@model NBD6.Models.Bid

@{
    ViewData["Title"] = "Create";
}

<h1>Bid Create</h1>

<p>All fields marked with * are required to create a bid.</p>

<form asp-action="Create">
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

    <div class="row">
        <div class="col-md-6">
            <!-- Bid Fields -->
            <h4>Bid</h4>
            <hr />
            <div class="form-group">
                <label asp-for="BidName" class="control-label">Bid Name<span class="text-danger">*</span></label>
                <input asp-for="BidName" class="form-control" placeholder="Enter bid name" required />
                <span asp-validation-for="BidName" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label asp-for="BidStart" class="control-label">Bid Start Date<span class="text-danger">*</span></label>
                <input asp-for="BidStart" class="form-control" type="date" required />
                <span asp-validation-for="BidStart" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label asp-for="BidEnd" class="control-label">Bid End Date<span class="text-danger">*</span></label>
                <input asp-for="BidEnd" class="form-control" type="date" required />
                <span asp-validation-for="BidEnd" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="ProjectID" class="control-label">Project<span class="text-danger">*</span></label>
                <select asp-for="ProjectID" class="form-control" id="ProjectID" asp-items="ViewBag.ProjectID">
                    <option value="">Select a Project</option>
                    @if (TempData["NewProjectID"] != null)
                    {
                        <option value="@TempData["NewProjectID"]" selected>@TempData["NewProjectSummary"]</option>
                    }
                </select>
                <a class="nav-link text-dark" asp-area="" asp-controller="Projects" asp-action="Create">Create a new Project</a>
            </div>
        </div>

        <!-- Material Fields -->
        <div id="material-fields">
            <div class="material-group">
                <div class="form-group">
                    <label class="control-label">Material Type<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="Materials[0].MaterialType" placeholder="ex: soil, bark, roses" required />
                </div>
                <div class="form-group">
                    <label class="control-label">Material Quantity<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="Materials[0].MaterialQuantity" placeholder="Enter quantity" required />
                </div>
                <div class="form-group">
                    <label class="control-label">Material Description<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="Materials[0].MaterialDescription" placeholder="Enter description" required />
                </div>
                <div class="form-group">
                    <label class="control-label">Material Size<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="Materials[0].MaterialSize" placeholder="Enter size" required />
                </div>
                <div class="form-group">
                    <label class="control-label">Material Price<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="Materials[0].MaterialPrice" placeholder="Enter price" required />
                </div>
                <!-- Add more material fields as needed -->
            </div>
        </div>
        <button type="button" class="btn btn-success" onclick="addMaterial()">Add Another Material</button>

        <!-- Labour Fields -->
        <div id="labour-fields">
            <div class="labour-group">
                <div class="form-group">
                    <label class="control-label">Labour Hours<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="Labours[0].LabourHours" placeholder="Please enter the number of hours worked" required />
                </div>
                <div class="form-group">
                    <label class="control-label">Labour Description<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="Labours[0].LabourDescription" placeholder="Enter description" required />
                </div>
                <div class="form-group">
                    <label class="control-label">Labour Price<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="Labours[0].LabourPrice" placeholder="Enter price" required />
                </div>
                <!-- Add more labour fields as needed -->
            </div>
        </div>
        <button type="button" class="btn btn-success" onclick="addLabour()">Add Another Labour</button>



     <div class="col-md-6">
            <h4>Staff</h4>
            <hr />
        <div id="staffContainer">
            <div class="staffFields">
                <label asp-for="Staff" class="control-label">Staff<span class="text-danger">*</span></label>
                <select asp-for="Staff" class="form-control" asp-items="ViewBag.StaffID" name="StaffIDList">
                    <option value="">Select Staff</option>
                </select>
            </div>            
        </div>
            <button type="button" id="addStaffBtn" class="btn btn-primary">Add More Staff</button>
     </div>
        

            
    <!-- Autofill button -->
    <div class="form-group">
        <input type="submit" value="Create" class="btn btn-primary" />
        <button type="button" class="btn btn-secondary" onclick="autofill()">Autofill Form</button>
        <span id="autofill-message" class="text-success"></span>
    </div>
</form>

<div class="col-md-1">
    <div>
        <a class="nav-link text-dark" href="javascript:history.back()">Go Back</a>
    </div>
</div>

@section Scripts {
    <script>
        var materialCounter = 1; // Initialize counters
        var labourCounter = 1;

        function addMaterial() {
            var materialFields = document.getElementById("material-fields");
            var newMaterialGroup = document.createElement("div");
            newMaterialGroup.classList.add("material-group");
            newMaterialGroup.innerHTML = `
                <div class="form-group">
                    <label class="control-label">Material Type<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="Materials[${materialCounter}].MaterialType" placeholder="ex: soil, bark, roses" required />
                </div>
                <div class="form-group">
                    <label class="control-label">Quantity<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="Materials[${materialCounter}].Quantity" placeholder="Quantity" required />
                </div>
                <div class="form-group">
                    <label class="control-label">Material Description<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="Materials[${materialCounter}].MaterialDescription" placeholder="Enter description" required />
                </div>
                <div class="form-group">
                    <label class="control-label">Material Size<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="Materials[${materialCounter}].MaterialSize" placeholder="Enter size" required />
                </div>
                <div class="form-group">
                    <label class="control-label">Material Price<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="Materials[${materialCounter}].MaterialPrice" placeholder="Enter price" required />
                </div>

            `;
            materialFields.appendChild(newMaterialGroup);
            materialCounter++; // Increment counter for the next material
        }

        function addLabour() {
            var labourFields = document.getElementById("labour-fields");
            var newLabourGroup = document.createElement("div");
            newLabourGroup.classList.add("labour-group");
            newLabourGroup.innerHTML = `
                <div class="form-group">
                    <label class="control-label">Labour Hours<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="Labours[${labourCounter}].LabourHours" placeholder="Please enter the number of hours worked" required />
                </div>
                <div class="form-group">
                    <label class="control-label">Description<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="Labours[${labourCounter}].Description" placeholder="Description" required />
                </div>
                <div class="form-group">
                    <label class="control-label">Labour Price<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="Labours[${labourCounter}].LabourPrice" placeholder="Enter price" required />
                </div>

            `;
            labourFields.appendChild(newLabourGroup);
            labourCounter++; // Increment counter for the next labour
        }
    </script>
}
